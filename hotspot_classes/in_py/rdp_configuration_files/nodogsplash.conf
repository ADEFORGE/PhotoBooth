#############################################################################
# NoDogSplash configuration for Photobooth captive portal
#############################################################################

# Interface gérée par NoDogSplash
GatewayInterface wlan0

# Adresse IP du Raspberry Pi sur wlan0
GatewayAddress 192.168.5.1

# Port HTTP utilisé par NoDogSplash (par défaut 2050, vous pouvez laisser)
GatewayPort 80

# Nom du portail (affiché par certaines UI, non critique)
GatewayName photobooth

# Page splash à servir par défaut
SplashPage splash.html

# Page de statut (quand déjà authentifié)
StatusPage status.html

# === REDIRECTION AUTOMATIQUE ===
# Toute requête HTTP (y compris les check captive de Google, Samsung, etc.)
# sera répondue par un 302 vers http://photobooth/
RedirectURL http://192.168.5.1/splash.html

# === Limites et timeouts ===
# Nombre max de clients
MaxClients 250

# Temps max de session (en secondes) après authentification
AuthIdleTimeout 300

# === Règles de firewall avant auth ===
FirewallRuleSet preauthenticated-users {
    FirewallRule allow tcp port 53    # DNS
    FirewallRule allow udp port 53
}

# === Règles de firewall une fois auth ===
FirewallRuleSet authenticated-users {
    FirewallRule allow all
}

# === Accès au routeur lui‑même ===
FirewallRuleSet users-to-router {
    FirewallRule allow udp port 53
    FirewallRule allow tcp port 53
    FirewallRule allow udp port 67    # DHCP
    FirewallRule allow tcp port 22    # SSH, si nécessaire
    FirewallRule allow tcp port 80    # HTTP (admin)
    FirewallRule allow tcp port 443   # HTTPS (admin)
}


# === Politique par défaut ===
# (laisser les autres sections à leurs valeurs par défaut)
